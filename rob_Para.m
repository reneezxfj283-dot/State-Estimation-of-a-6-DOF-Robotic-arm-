% 假设质心位于连杆中心，ri各连杆质心局部坐标
r0=[0; 0; 0.08375];           
r1=[0; -0.0724; 0];
r2=[0.313; 0; 0];
r3=[0.28775; 0; -0.1305];
r4=[0; 0.053; 0];
r5=[0; -0.0513; 0];
r_all = {r0,r1,r2,r3,r4,r5};

% 模型1：末端负载 1kg
rob_para(1).masses = [3, 3, 5.5, 6, 2, 2.5];   
rob_para(1).r = r_all;
% 模型2：末端负载 5.5kg
rob_para(2).masses = [3, 3, 5.5, 6, 2, 7];     
rob_para(2).r = r_all;

Q = 0.35 * eye(12);
R = 1000 * eye(6);
trs = [0.9 0.1 ; 0.1 0.9];
T=0.001;
Ts = 10;

% model matrices(Data from Dynamic.m operation)
Ad1=[
1	6.4879e-07	6.4879e-07	6.4879e-07	-1.6067e-13 	0	 0.0010	   2.1626e-10	 2.1626e-10	    2.1626e-10	 -3.2135e-17	   0;
0	0.9999	          0          0	          0	        0	   0	   0.0010	         0	          0	               0	       0;
0	6.7748e-05	      1	         0	          0	        0	   0	   2.2583e-08	 0.0010	          0	               0	       0;
0	4.7095e-06	4.7095e-06	     1	    -1.4859e-06	    0	   0	   1.5698e-09	 1.5698e-09	    0.0010	     -4.9530e-10	   0;
0	-0.0001	    -0.0001	    -0.0001	          1	        0	   0	   -4.4016e-08	 -4.4016e-08	-4.4016e-08	  0.0010	       0;
0	-0.0001	    -0.0001	    -0.0001	     1.4859e-06	  0.9999   0	   -3.3441e-08	 -3.3441e-08	-3.3441e-08	  4.9530e-10	 0.001;
0	0.0013	     0.0013	     0.0013	     -6.427e-10	    0	   1	   6.4879e-07	 6.4879e-07	     6.4879e-07	  -1.6067e-13	   0;
0	-0.1355        	0	        0	          0	        0	   0	   0.9999	         0	            0	           0	       0;
0	0.1355	        0	        0	          0	        0	   0	   6.7748e-05	     1	            0	           0	       0;
0	0.0094	     0.0094	      0.0094	  -0.003	    0	   0	   4.7095e-06	  4.7095e-06	    1	      -1.4859e-06	   0;
0	-0.2641	     -0.2641	 -0.2641	  1.3081e-07	0	   0	   -0.0001	      -0.0001	      -0.0001	       1	       0;
0	-0.2006	     -0.2006	 -0.2006	  0.003	     -0.1912   0	   -0.0001	      -0.0001	      -0.0001	   1.4859e-06	0.9999];

Ad2=[
1	2.6391e-06	2.6391e-06	2.6391e-06	-2.6587e-12	    0	   0.001	8.7971e-10	 8.7971e-10	   8.7971e-10    -5.3173e-16	 0;
0	0.9999	         0	         0	          0	        0	     0	    0.001	          0	          0	            0	         0;
0	6.7748e-05	     1	         0	          0	        0	     0	    2.2583e-08	 0.001	          0	            0	         0;
0	9.4196e-06	9.4196e-06	     1	    -6.0444e-06	    0	     0	    3.1398e-09	 3.1398e-09	   0.001	     -2.0148e-09	 0;
0	-0.0005	    -0.0005	    -0.0005	          1	        0	     0	    -1.7905e-07	 -1.7905e-07   -1.7905e-07	 0.001	         0;
0	-0.0001	    -0.0001	     -0.0001	6.0444e-06	  0.9999	 0	    -3.5011e-08	 -3.5011e-08   -3.5011e-08	 2.0148e-09	   0.001;
0	0.0053	       0.0053	   0.0053	-1.0635e-08	    0	     1	    2.6391e-06	  2.6391e-06	2.6391e-06	 -2.6587e-12	 0;
0	-0.1355          0	         0	          0	        0	     0	       0.9999	      0	           0	        0	         0;
0	0.1355	         0	         0	          0	        0	     0	     6.7748e-05	      1	           0	        0	         0;
0	0.0188	       0.0188	  0.0188	   -0.0121	    0	     0	      9.4196e-06	9.4196e-06	   1	     -6.0444e-06	 0;
0	-1.0743	     -1.0743	  -1.0743	   2.1645e-06	0	     0	       -0.0005	     -0.0005	 -0.0005	    1	         0;
0	-0.2101	     -0.2101	  -0.2101	    0.0121	  -0.1912	 0	      -0.0001	     -0.0001	 -0.0001	 6.0444e-06	   0.9999];

Bd1=[
4.3944e-07	 -1.023e-27	      1.023e-27	      1.0883e-13	-4.39443e-07	-1.0883e-13;
0	          3.1796e-05	 -3.17956e-05	      0	             0	             0;
0	         -3.1796e-05	  3.2724e-05     -9.2794e-07	         0	         0;
1.0883e-13	 -5.6574e-27	 -9.2794e-07	  1.9344e-06	-2.215e-11	    -1.0064e-06;
-4.3944e-07	  1.0252e-24	 -8.0108e-25     -2.215e-11	     8.9439e-05	     2.215e-11;
-1.0883e-13	  4.1395e-26	  1.8269e-25	 -1.0064e-06	 2.215e-11	     7.7002e-05;
0.0009	     -4.1655e-24	  4.1655e-24	  4.3531e-10	-0.0009	        -4.3531e-10;
0	          0.0636	     -0.0636	           0	         0	             0;
0	         -0.0636	      0.06546	     -0.0019	         0	             0;
4.3531e-10	 -2.703e-23	     -0.0019	      0.0039	    -8.85999e-08	-0.0020;
-0.0009	      2.4054e-21	 -2.2075e-21	 -8.86e-08	     0.1789	         8.86e-08;
-4.3531e-10	  5.7502e-22	 -1.8581e-22	 -0.0020	     8.86e-08	     0.1540];

Bd2=[
4.3944e-07	-4.5026e-27	4.5026e-27	4.4269e-13	-4.3944e-07	-4.4269e-13;
0	3.1796e-05	-3.1796e-05	0	0	0;
0	-3.1796e-05	3.2724e-05	-9.2794e-07	0	0;
4.4269e-13	-4.4351e-26	-9.2794e-07	1.9344e-06	-9.0100e-11	-1.0064e-06;
-4.3944e-07	2.5600e-24	-1.6637e-24	-9.0100e-11	8.9439e-05	9.0100e-11;
-4.4269e-13	4.5376e-25	-3.417e-25	-1.0064e-06	9.0100e-11	2.8148e-05;
0.0009	-1.7786e-23	1.7786e-23	1.7708e-09	-0.0009	-1.7708e-09;
0	0.0636	-0.0636	0	0	0;
0	-0.0636	0.0654	-0.0019	0	0;
1.7708e-09	-9.4422e-23	-0.0019	0.0039	-3.6040e-07	-0.0020;
-0.0009	5.6831e-21	-4.8796e-21	-3.6040e-07	0.1789	3.6040e-07;
-1.7708e-09	8.6882e-22	-7.0729e-22	-0.0020	3.6040e-07	0.0563];


